parameters:
    uecode_image.handling.class: Uecode\Bundle\ImageBundle\Services\ImageService
    uecode_image.handler.class: Uecode\Bundle\ImageBundle\Handler\ImageHandler

services:
    # Image handling factory
    image.handling:
        class: %uecode_image.handling.class%
        scope: request
        arguments:
            - %uecode_image.handler.class%
            - %uecode_image.throw_exception%
            - %uecode_image.fallback_image%

    uecode_image.upload_handler:
        class: Uecode\Bundle\ImageBundle\Services\UploadHandler
        scope: request
        arguments:
            - @request
            - @filesystem
            - %kernel.root_dir%
            - %uecode_image.tmp_dir%
            - %uecode_image.upload_dir%
            - @image.handling
            - %uecode_image.provider%
            - @uecode_image.provider.aws
            - %aws.s3.bucket%
            - %aws.s3.directory%

    uecode_image.routing_loader:
        class: Uecode\Bundle\ImageBundle\Routing\RouteLoader
        arguments: [ '%uecode_image.route%' , 'UecodeImageBundle:Uploader:Upload']
        tags:
            - { name: routing.loader }
